# 测评结果

```
mnet-batch6-n512-k32-d128-fwd:
        n      origin      pscan  pscan_torch
0   512.0   53.303295   3.442812     3.191888
1  1024.0  106.347137   6.151117     6.155437
2  2048.0  283.402374  13.274240    12.101308
3  4096.0  518.525757  25.400970    23.969999
mnet-batch6-n512-k32-d128-bwd:
        n       origin      pscan  pscan_torch
0   512.0   157.917465   5.060667     6.297593
1  1024.0   352.005646   9.863688    12.225351
2  2048.0  1161.564453  19.460768    24.039896
3  4096.0  4166.651367  38.744625    47.717392
mnet-batch6-n512-k32-d128-fwd:
        n      origin        pscan  pscan_torch
0   512.0   66.882812   955.532227    666.40625
1  1024.0  118.007812  1893.719727   1315.53125
2  2048.0  218.757812  3769.157227   2613.78125
3  4096.0  422.007812  7521.407227   5211.03125
mnet-batch6-n512-k32-d128-bwd:
        n       origin        pscan   pscan_torch
0   512.0   160.156641  1265.160352   1289.271875
1  1024.0   304.706641  2512.760352   2561.246875
2  2048.0   591.706641  5005.410352   5102.009375
3  4096.0  1168.756641  9993.772852  10187.221875
```

C=128, fwd
```
mnet-batch6-n512-k32-d128-fwd:
        n      origin      pscan  pscan_torch  pscan_block
0   512.0   57.051231   3.557913     3.186864     3.463833
1  1024.0  104.708191   6.144403     6.136933     6.920875
2  2048.0  288.376984  13.471946    12.095492    13.673343
3  4096.0  513.026550  24.002121    23.932199    27.359797
mnet-batch6-n512-k32-d128-bwd:
        n       origin      pscan  pscan_torch  pscan_block
0   512.0   156.806915   5.058154     6.237276     7.583300
1  1024.0   345.075867   9.851870    12.115171    14.987454
2  2048.0  1159.795288  19.441107    23.843353    29.587626
3  4096.0  4154.512207  38.721794    47.478897    58.998142
mnet-batch6-n512-k32-d128-fwd:
        n      origin        pscan  pscan_torch  pscan_block
0   512.0   66.882812   955.532227    666.40625   366.828125
1  1024.0  118.007812  1893.719727   1315.53125   392.703125
2  2048.0  218.757812  3769.157227   2613.78125   444.453125
3  4096.0  422.007812  7521.407227   5211.03125   548.703125
mnet-batch6-n512-k32-d128-bwd:
        n       origin        pscan  pscan_torch  pscan_block
0   512.0   160.156641  1265.160352  1241.084375   498.818750
1  1024.0   304.706641  2512.760352  2465.059375   646.059375
2  2048.0   591.706641  5005.410352  4909.821875   935.993750
3  4096.0  1168.756641  9993.772852  9803.034375  1593.059375
```

```
mnet-batch4-n512-k128-d128-fwd:
        n      origin      pscan  pscan_torch  pscan_block
0   512.0   52.415199   7.161311     6.975493     7.436278
1  1024.0  102.441795  13.106833    13.087407    15.112502
2  2048.0  283.934631  25.892021    25.900841    29.498026
3  4096.0  513.687439  51.870590    51.859329    59.023712
mnet-batch4-n512-k128-d128-bwd:
        n        origin      pscan  pscan_torch  pscan_block
0   512.0    208.883774  11.403955    13.096425    16.603149
1  1024.0    720.007629  22.542150    25.836586    32.483528
2  2048.0   2638.507324  44.861710    51.220833    64.598755
3  4096.0  10148.565430  89.672707   102.606110   129.068451
mnet-batch4-n512-k128-d128-fwd:
        n      origin         pscan  pscan_torch  pscan_block
0   512.0   146.78125   2518.000977       1748.5      948.875
1  1024.0   277.28125   5016.000977       3478.0     1014.875
2  2048.0   538.28125  10012.000977       6937.0     1146.875
3  4096.0  1060.28125  20004.000977      13855.0     1410.875
mnet-batch4-n512-k128-d128-bwd:
        n       origin         pscan  pscan_torch  pscan_block
0   512.0   392.808203   3341.875977     3276.775     1293.525
1  1024.0   769.208203   6660.875977     6532.175     1672.925
2  2048.0  1522.008203  13298.875977    13042.975     2429.725
3  4096.0  3027.608203  26573.875977    26064.575     4132.450
```

## example
```
dm4 = f5 * dm5 + s4
dm3 = f4 * dm4 + s3

dm2 = f3 * dm3 + s2
dm1 = f2 * dm2 + s1
```

## to do
- [ ] mnet cuda